<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A Minimal Book Example</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Minimal Book Example" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Yihui Xie">


<meta name="date" content="2018-05-01">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="modelado.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="transformacion-i.html"><a href="transformacion-i.html"><i class="fa fa-check"></i><b>2</b> Transformación-I</a><ul>
<li class="chapter" data-level="2.1" data-path="transformacion-i.html"><a href="transformacion-i.html#que-aprendimos-la-clase-pasada"><i class="fa fa-check"></i><b>2.1</b> ¿Qué aprendimos la clase pasada?</a></li>
<li class="chapter" data-level="2.2" data-path="transformacion-i.html"><a href="transformacion-i.html#esta-clase"><i class="fa fa-check"></i><b>2.2</b> Esta clase:</a></li>
<li class="chapter" data-level="2.3" data-path="transformacion-i.html"><a href="transformacion-i.html#esta-seccion-del-curso-se-compone-por-dos-clases.-en-la-siguiente"><i class="fa fa-check"></i><b>2.3</b> Esta sección del curso se compone por dos clases. En la siguiente:</a></li>
<li class="chapter" data-level="2.4" data-path="transformacion-i.html"><a href="transformacion-i.html#conceptos-preliminares"><i class="fa fa-check"></i><b>2.4</b> Conceptos preliminares:</a><ul>
<li class="chapter" data-level="2.4.1" data-path="transformacion-i.html"><a href="transformacion-i.html#r-como-una-calculadora"><i class="fa fa-check"></i><b>2.4.1</b> R como una calculadora</a></li>
<li class="chapter" data-level="2.4.2" data-path="transformacion-i.html"><a href="transformacion-i.html#asignacion-de-objetos-en-r"><i class="fa fa-check"></i><b>2.4.2</b> Asignación de objetos en R</a></li>
<li class="chapter" data-level="2.4.3" data-path="transformacion-i.html"><a href="transformacion-i.html#funciones-en-r"><i class="fa fa-check"></i><b>2.4.3</b> Funciones en R</a></li>
<li class="chapter" data-level="2.4.4" data-path="transformacion-i.html"><a href="transformacion-i.html#scripts-en-r"><i class="fa fa-check"></i><b>2.4.4</b> Scripts en R</a></li>
<li class="chapter" data-level="2.4.5" data-path="transformacion-i.html"><a href="transformacion-i.html#diagnosticos-de-rstudio"><i class="fa fa-check"></i><b>2.4.5</b> Diagnósticos de RStudio</a></li>
<li class="chapter" data-level="2.4.6" data-path="transformacion-i.html"><a href="transformacion-i.html#operadores-relacionales"><i class="fa fa-check"></i><b>2.4.6</b> Operadores relacionales</a></li>
<li class="chapter" data-level="2.4.7" data-path="transformacion-i.html"><a href="transformacion-i.html#operadores-booleanos"><i class="fa fa-check"></i><b>2.4.7</b> Operadores booleanos</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="transformacion-i.html"><a href="transformacion-i.html#el-paquete-dplyr-instalado-con-el-tidyverse"><i class="fa fa-check"></i><b>2.5</b> El paquete dplyr (instalado con el tidyverse)</a><ul>
<li class="chapter" data-level="2.5.1" data-path="transformacion-i.html"><a href="transformacion-i.html#seleccionar-campos-de-un-data-frame-selectdf-columnas_a_seleccionar"><i class="fa fa-check"></i><b>2.5.1</b> 1. Seleccionar campos de un data frame: select(df, columnas_a_seleccionar)</a></li>
<li class="chapter" data-level="2.5.2" data-path="transformacion-i.html"><a href="transformacion-i.html#filtrar-registros-de-un-data-frame-que-cumplen-cierta-condicion-filterdf-condiciones"><i class="fa fa-check"></i><b>2.5.2</b> 2. Filtrar registros de un data frame que cumplen cierta condición: filter(df, condiciones)</a></li>
<li class="chapter" data-level="2.5.3" data-path="transformacion-i.html"><a href="transformacion-i.html#ordenar-registros-de-un-data-frame-por-los-valores-en-una-o-mas-variables-arrangedf-variables_de_ordenamiento"><i class="fa fa-check"></i><b>2.5.3</b> 3. Ordenar registros de un data frame por los valores en una o más variables: arrange(df, variables_de_ordenamiento)</a></li>
<li class="chapter" data-level="2.5.4" data-path="transformacion-i.html"><a href="transformacion-i.html#crear-nuevas-variables-mutatedf-formulas"><i class="fa fa-check"></i><b>2.5.4</b> 4. Crear nuevas variables: mutate(df, formulas)</a></li>
<li class="chapter" data-level="2.5.5" data-path="transformacion-i.html"><a href="transformacion-i.html#agrupar-por-ciertas-variables-group_bydata_frame-variables-y-crear-resumenes-por-grupo-summarisedata_frame-formulas"><i class="fa fa-check"></i><b>2.5.5</b> 5. Agrupar por ciertas variables: group_by(data_frame, variables) y crear resúmenes por grupo: summarise(data_frame, formulas)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="transformacion-ii.html"><a href="transformacion-ii.html"><i class="fa fa-check"></i><b>3</b> Transformación-II</a><ul>
<li class="chapter" data-level="3.1" data-path="transformacion-ii.html"><a href="transformacion-ii.html#que-aprendimos-la-clase-pasada-1"><i class="fa fa-check"></i><b>3.1</b> ¿Qué aprendimos la clase pasada?</a></li>
<li class="chapter" data-level="3.2" data-path="transformacion-ii.html"><a href="transformacion-ii.html#el-operador-pipeline"><i class="fa fa-check"></i><b>3.2</b> El operador pipeline %&gt;%</a></li>
<li class="chapter" data-level="3.3" data-path="transformacion-ii.html"><a href="transformacion-ii.html#miscelanea-de-funcionalidades-avanzadas-de-transformacion-de-datos"><i class="fa fa-check"></i><b>3.3</b> Miscelánea de funcionalidades avanzadas de transformación de datos</a><ul>
<li class="chapter" data-level="3.3.1" data-path="transformacion-ii.html"><a href="transformacion-ii.html#joins-inner_joindf1-df2-columnas_a_seleccionar"><i class="fa fa-check"></i><b>3.3.1</b> 1. Joins: inner_join(df1, df2, columnas_a_seleccionar)</a></li>
<li class="chapter" data-level="3.3.2" data-path="transformacion-ii.html"><a href="transformacion-ii.html#un-intermedio.-lectura-de-datos-en-r"><i class="fa fa-check"></i><b>3.3.2</b> Un intermedio. Lectura de datos en R</a></li>
<li class="chapter" data-level="3.3.3" data-path="transformacion-ii.html"><a href="transformacion-ii.html#usar-spread-para-transformar-registros-de-un-data-frame-en-campos."><i class="fa fa-check"></i><b>3.3.3</b> 2. Usar spread para transformar registros de un data frame en campos.</a></li>
<li class="chapter" data-level="3.3.4" data-path="transformacion-ii.html"><a href="transformacion-ii.html#usar-gather-para-transformar-campos-de-un-data-frame-en-registros"><i class="fa fa-check"></i><b>3.3.4</b> 3. Usar gather para transformar campos de un data frame en registros</a></li>
<li class="chapter" data-level="3.3.5" data-path="transformacion-ii.html"><a href="transformacion-ii.html#separar-una-columna-en-dos-o-mas-separatedf-col-columna-into-cnueva_variable_1-nueva_variable_2-etc"><i class="fa fa-check"></i><b>3.3.5</b> 4. Separar una columna en dos o más: separate(df, col = columna, into = c(nueva_variable_1, nueva_variable_2, etc)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="transformacion-ii.html"><a href="transformacion-ii.html#datos-faltantes"><i class="fa fa-check"></i><b>3.4</b> Datos faltantes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="funciones.html"><a href="funciones.html"><i class="fa fa-check"></i><b>4</b> Funciones</a><ul>
<li class="chapter" data-level="4.1" data-path="funciones.html"><a href="funciones.html#que-aprendimos-la-clase-pasada-2"><i class="fa fa-check"></i><b>4.1</b> ¿Qué aprendimos la clase pasada?</a></li>
<li class="chapter" data-level="4.2" data-path="funciones.html"><a href="funciones.html#funciones-en-r-1"><i class="fa fa-check"></i><b>4.2</b> Funciones en R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="funciones.html"><a href="funciones.html#cuando-es-conveniente-escribir-funciones"><i class="fa fa-check"></i><b>4.2.1</b> ¿Cuándo es conveniente escribir funciones?</a></li>
<li class="chapter" data-level="4.2.2" data-path="funciones.html"><a href="funciones.html#escribiendo-funciones-en-r"><i class="fa fa-check"></i><b>4.2.2</b> Escribiendo funciones en R</a></li>
<li class="chapter" data-level="4.2.3" data-path="funciones.html"><a href="funciones.html#expresiones-condicionales"><i class="fa fa-check"></i><b>4.2.3</b> Expresiones condicionales</a></li>
<li class="chapter" data-level="4.2.4" data-path="funciones.html"><a href="funciones.html#de-regreso-al-tidyverse"><i class="fa fa-check"></i><b>4.2.4</b> De regreso al tidyverse</a></li>
<li class="chapter" data-level="4.2.5" data-path="funciones.html"><a href="funciones.html#ambientes"><i class="fa fa-check"></i><b>4.2.5</b> Ambientes</a></li>
<li class="chapter" data-level="4.2.6" data-path="funciones.html"><a href="funciones.html#estilos-de-codigo-y-buenas-practicas"><i class="fa fa-check"></i><b>4.2.6</b> Estilos de código y buenas prácticas</a></li>
<li class="chapter" data-level="4.2.7" data-path="funciones.html"><a href="funciones.html#temas-avanzados-de-funciones-opcional"><i class="fa fa-check"></i><b>4.2.7</b> Temas avanzados de funciones (OPCIONAL)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="funciones.html"><a href="funciones.html#las-funciones-pueden-llamarse-a-si-mismas."><i class="fa fa-check"></i><b>4.3</b> <em>Las funciones pueden llamarse a si mismas.</em></a></li>
<li class="chapter" data-level="4.4" data-path="funciones.html"><a href="funciones.html#las-funciones-pueden-regresar-funciones"><i class="fa fa-check"></i><b>4.4</b> <em>Las funciones pueden regresar funciones</em>:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vectores.html"><a href="vectores.html"><i class="fa fa-check"></i><b>5</b> Vectores</a><ul>
<li class="chapter" data-level="5.1" data-path="vectores.html"><a href="vectores.html#que-aprendimos-la-clase-pasada-3"><i class="fa fa-check"></i><b>5.1</b> ¿Qué aprendimos la clase pasada?</a></li>
<li class="chapter" data-level="5.2" data-path="vectores.html"><a href="vectores.html#vectores-listas-y-arreglos"><i class="fa fa-check"></i><b>5.2</b> Vectores, listas y arreglos</a></li>
<li class="chapter" data-level="5.3" data-path="vectores.html"><a href="vectores.html#iteracion-en-r"><i class="fa fa-check"></i><b>5.3</b> Iteración en R</a><ul>
<li class="chapter" data-level="5.3.1" data-path="vectores.html"><a href="vectores.html#iteracion-imperativa"><i class="fa fa-check"></i><b>5.3.1</b> Iteración imperativa</a></li>
<li class="chapter" data-level="5.3.2" data-path="vectores.html"><a href="vectores.html#iteracion-funcional"><i class="fa fa-check"></i><b>5.3.2</b> Iteración funcional</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelado.html"><a href="modelado.html"><i class="fa fa-check"></i><b>6</b> Modelado</a><ul>
<li class="chapter" data-level="6.0.1" data-path="modelado.html"><a href="modelado.html#muestras-complejas"><i class="fa fa-check"></i><b>6.0.1</b> Muestras complejas</a></li>
<li class="chapter" data-level="6.0.2" data-path="modelado.html"><a href="modelado.html#diseno-enigh"><i class="fa fa-check"></i><b>6.0.2</b> Diseño ENIGH</a></li>
<li class="chapter" data-level="6.0.3" data-path="modelado.html"><a href="modelado.html#ejemplo-patrones-de-gasto-por-decil"><i class="fa fa-check"></i><b>6.0.3</b> Ejemplo: patrones de gasto por decil</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="modelado-1.html"><a href="modelado-1.html"><i class="fa fa-check"></i><b>7</b> Modelado</a><ul>
<li class="chapter" data-level="7.1" data-path="modelado-1.html"><a href="modelado-1.html#que-aprendimos-la-clase-pasada-4"><i class="fa fa-check"></i><b>7.1</b> ¿Qué aprendimos la clase pasada?</a></li>
<li class="chapter" data-level="7.2" data-path="modelado-1.html"><a href="modelado-1.html#modelos"><i class="fa fa-check"></i><b>7.2</b> Modelos</a><ul>
<li class="chapter" data-level="7.2.1" data-path="modelado-1.html"><a href="modelado-1.html#generacion-de-hipotesis-vs-confirmacion-de-hipotesis"><i class="fa fa-check"></i><b>7.2.1</b> Generación de hipótesis vs confirmación de hipótesis</a></li>
<li class="chapter" data-level="7.2.2" data-path="modelado-1.html"><a href="modelado-1.html#especificacion-de-modelos"><i class="fa fa-check"></i><b>7.2.2</b> Especificación de modelos</a></li>
<li class="chapter" data-level="7.2.3" data-path="modelado-1.html"><a href="modelado-1.html#un-primer-modelo-simple"><i class="fa fa-check"></i><b>7.2.3</b> Un primer modelo simple</a></li>
<li class="chapter" data-level="7.2.4" data-path="modelado-1.html"><a href="modelado-1.html#un-modelo-sobre-datos-mas-interesantes"><i class="fa fa-check"></i><b>7.2.4</b> Un modelo sobre datos más interesantes</a></li>
<li class="chapter" data-level="7.2.5" data-path="modelado-1.html"><a href="modelado-1.html#visualizacion-de-predicciones"><i class="fa fa-check"></i><b>7.2.5</b> visualización de predicciones</a></li>
<li class="chapter" data-level="7.2.6" data-path="modelado-1.html"><a href="modelado-1.html#visualizacion-de-residuales"><i class="fa fa-check"></i><b>7.2.6</b> visualización de residuales</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelado-1" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Modelado</h1>
<div id="que-aprendimos-la-clase-pasada-4" class="section level2">
<h2><span class="header-section-number">7.1</span> ¿Qué aprendimos la clase pasada?</h2>
<ul>
<li>Cómo analizar muestras complejas en R</li>
</ul>
<p>En esta clase aprenderemos a:</p>
<ul>
<li>Utilizar modelos estadísticos para exploración de datos y para probar hipótesis.</li>
</ul>
</div>
<div id="modelos" class="section level2">
<h2><span class="header-section-number">7.2</span> Modelos</h2>
<p>El objetivo primordial de los modelos estadísticos es el de proveer un sumario simple de baja dimensión de un conjunto de datos.</p>
<p>Idealmente un modelo captura la señal de interés (los patrones reals y generales del fenómeno que queremos estudiar) e ignora el “ruido” (e.g. variación aleatoria que no es de nuestro interés).</p>
<p>Vamos a proceder a estudiar cuál es la mecánica detrás de los modelos estadísticos concentrándonos en una familia muy importante de ellos: los modelos lineales.</p>
<div id="generacion-de-hipotesis-vs-confirmacion-de-hipotesis" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Generación de hipótesis vs confirmación de hipótesis</h3>
<p>Tradicionalmente, el objetivo del modelado estadístico fue la inferencia:plantear y comprobar hipótesis. Hacer esto correctamente no es complicado pero es difícil.</p>
<p>Hay que entender un par de ideas para poder llevar a cabo inferencia de una manera correcta:</p>
<ul>
<li><p>Cada observación de nuestro conjunto de datos base se puede usar para exploración o para confirmación pero nunca para ambas.</p></li>
<li><p>Puedes usar una observación las veces que quieras para exploración, pero sólo la puedes usar una vez para confirmación. En cuanto uses una observación más de una vez estás automáticamente participando en un ejercicio exploratorio y no de confirmación.</p></li>
</ul>
<p>Esto es necesario porque para confirmar una hipótesis se deben de usar datos independientes a los que se usaron para generar la hipótesis. De otra manera se está siendo optimista en cuanto a la solidéz de la hipótesis.</p>
<p>Se verá más adelante pero para llevar a cabo un análisis de confirmación para modelos estadísticos una manera de proceder es partiendo tu conjunto de datos en tres subconjuntos:</p>
<ul>
<li><p>~60% para explorar y entrenar tu modelo. Tienes permitido hacer lo que sea con este subconjunto de tus datos: manipularlo a gusto, visualizarlo, ajustarle un montón de modelos, etc.</p></li>
<li><p>~20% un conjunto de consulta. Sirve para comparar modelos o visualizaciones, pero no está permitido usarlo en el ajuste de modelos.</p></li>
<li><p>~20% es el conjunto de prueba final. Sólo se puede usar este conjunto de datos UNA vez, para probar tu modelo final.</p></li>
</ul>
<p>Esta partición permite explorar tus datos de entrenamiento, ocasionalmente generando hipótesis candidatas que se contrastan usando el conjunto de consulta. Cuando se tiene confianza en tener un buen modelo, se puede evaluar en el conjunto de prueba.</p>
</div>
<div id="especificacion-de-modelos" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Especificación de modelos</h3>
<p>Hay dos partes fundamentales en un modelo:</p>
<ul>
<li>Primero, se define una familia de modelos que expresa de manera precisa, pero genérica, el patrón que se quiere capturar. Por ejemplo el patrón puede ser una línea recta:</li>
</ul>
<p><span class="math display">\[ Y = \beta_{0} + \beta_{1}*X \]</span></p>
<p>Aquí, Y y X son variables conocidos de tus datos. <span class="math inline">\(\beta_{0}\)</span> y <span class="math inline">\(\beta_{1}\)</span> son parámetros que pueden capturar distintos patrones.</p>
<ul>
<li>Luego, en el ejercicio de modelado se encuentran los parámetros a la hora de ajustar el modelo, de manera tal que el modelo se encuentre “lo más cerca posible” a tus datos, por ejemplo:</li>
</ul>
<p><span class="math display">\[ Y = 3 + 11X \]</span></p>
<p>Es importante recalcar que el modelo ajustado es el modelo más cercano a tus datos pero de una familia particular de modelos escogida a priori. Esto implica que se tiene el “mejor” modelo dado un cierto criterio muy particular. Definitivamente no implica que se tiene un buen modelo o que el modelo es “cierto”:</p>
<p><img src="imagenes/box.png" width="318" /></p>
</div>
<div id="un-primer-modelo-simple" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Un primer modelo simple</h3>
<p>Echémosle un vistazo a el conjunto de datos simulados sim1 (vienen en el tidyverse)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># carguemos los paquetes</span>

<span class="kw">library</span>(tidyverse)

<span class="kw">library</span>(modelr)

<span class="kw">head</span>(sim1)
<span class="co">#&gt; # A tibble: 6 x 2</span>
<span class="co">#&gt;       x     y</span>
<span class="co">#&gt;   &lt;int&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1     1  4.20</span>
<span class="co">#&gt; 2     1  7.51</span>
<span class="co">#&gt; 3     1  2.13</span>
<span class="co">#&gt; 4     2  8.99</span>
<span class="co">#&gt; 5     2 10.2 </span>
<span class="co">#&gt; 6     2 11.3</span></code></pre></div>
<p>Como podrán ver, consta de dos variables continuas únicamente (x,y).</p>
<p>Podemos usar lo aprendido en clases pasadas para visualizar la relación entre estas dos variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(sim1, <span class="kw">aes</span>(x, y)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-124-1.png" width="288" /></p>
<p>Es claro que existe un patrón fuerte entre las dos variables (¿Qué tipo?).</p>
<p>Ahora es nuestra tarea proponer un modelo para este conjunto de datos que capture el patrón de la mejor manera posible.</p>
<p><img src="imagenes/manicule2.jpg" /> Usar la función runif(), consultar su ayuda y explicar con sus palabras qué hace.</p>
<p>La función anterior nos dejará generar una gran cantidad de parámetros para producir modelos candidatos (como hemos venido trabajando sólo son dos parámetros los que requerimos para datos con dos variables).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># parametros</span>
modelos &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">beta0 =</span> <span class="kw">runif</span>(<span class="dv">250</span>, <span class="op">-</span><span class="dv">20</span>, <span class="dv">40</span>),
  <span class="dt">beta1 =</span> <span class="kw">runif</span>(<span class="dv">250</span>, <span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)
)

<span class="kw">ggplot</span>(sim1, <span class="kw">aes</span>(x, y)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="kw">aes</span>(<span class="dt">intercept =</span> beta0, <span class="dt">slope =</span> beta1), <span class="dt">data =</span> modelos, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-125-1.png" width="288" /></p>
<p>Pintamos 250 modelos candidatos sobre nuestros datos simulados ¡Muchos de ellos son realmente malos!</p>
<p>¿Cómo le hacemos para encontrar un buen modelo? ¿Cómo se formaliza la idea de que un buen modelo es uno que está “cerca” de nuestros datos? Necesitamos una manera de cuantificar la distancia de un modelo candidato a nuestros datos.Luego podemos buscar un modelo que encuentre valors para <span class="math inline">\(\beta_{0}\)</span> y <span class="math inline">\(\beta_{1}\)</span> de manera tal que el modelo esté a la menor distancia posible de los datos.</p>
<p>Un buen lugar para empezar es encontrar la distancia vertical de cada punto de nuestros datos a nuestro modelo (en este caso una línea recta).</p>
<p><img src="imagenes/dists.png" width="576" /></p>
<p>La intuición detrás de el ajuste de varias familias de modelos es que si puedes establecer una función que defina la distancia entre el modelo y el conjunto de datos, entonces un algoritmo puede minimzar tal distancia, efectivamente encontrando los mejores parámetros para tu modelo. Una muy común es la suma de los cuadrados de las distancias verticales antes mostradas, eso se denomina ajuste por mínimos cuadrados.</p>
<p>R tiene varias herramientas y paquetes para trabajar con modelos. Una función clásica es lm() que permite ajustar modelos lineales como los que hemos venido viendo. R tiene varias manera de especificar los modelos que se buscan ajustar. Por ejemplo, con una estructura llamada fórmula: Y ~ X que se traduce en:</p>
<p><span class="math display">\[ Y = \beta_{0} + \beta_{1}*X \]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sim1_mod &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> sim1)

<span class="kw">coef</span>(sim1_mod)
<span class="co">#&gt; (Intercept)           x </span>
<span class="co">#&gt;        4.22        2.05</span></code></pre></div>
<p><img src="imagenes/manicule2.jpg" /> Una desventaja de los modelos lineales ajustados con mínimos cuadrados es que por tener términos al cuadrado se vuelven sensibles a valores inusuales (muy grandes - muy chicos). Ajusta un modelo a los datos simulados con el código abajo y visualiza los resultados ¿Qué notras sobre estos modelos?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
sim1a &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">x =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">each =</span> <span class="dv">3</span>),
  <span class="dt">y =</span> x <span class="op">*</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">+</span><span class="st"> </span><span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="kw">rt</span>(<span class="kw">length</span>(x), <span class="dt">df =</span> <span class="dv">2</span>)
)</code></pre></div>
</div>
<div id="un-modelo-sobre-datos-mas-interesantes" class="section level3">
<h3><span class="header-section-number">7.2.4</span> Un modelo sobre datos más interesantes</h3>
<p>En la carpeta datos se encuentran dos archivos. Uno de excel, con datos sobre ingresos per cápita por países. Otro, un archivo csv, con datos de esperanza de vida por países.</p>
<p><img src="imagenes/manicule2.jpg" /> Carguen estos datos en sus espacio de trabajo.</p>
<p>Con lo aprendido en las clases de manipulación y transformación de datos podemos convertir estas tablas de datos a otras que nos sirvan para estudiar la relación entre el ingreso per cápita y la esperanza de vida.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># seleccionar campos de datos de ingreso: sólo año 2010</span>
ingreso =<span class="st"> </span>ingreso <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">select</span>(<span class="dv">1</span>,<span class="st">&#39;2010&#39;</span>)

<span class="co"># renombrar columnas</span>
<span class="kw">colnames</span>(ingreso) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;pais&quot;</span>,<span class="st">&quot;GNI_capita_2010&quot;</span>)

<span class="co"># filtrar datos de esperanza de vida: año 2010, ambos sexos, 20-24 años</span>
esperanza =<span class="st"> </span>esperanza <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">            </span><span class="kw">filter</span>(year<span class="op">==</span><span class="dv">2010</span>,age_name<span class="op">==</span><span class="st">&quot;20-24 years&quot;</span>,sex_name<span class="op">==</span><span class="st">&quot;Both&quot;</span>)</code></pre></div>
<p><img src="imagenes/manicule2.jpg" /> ¿Qué usaríamos para juntar estas dos tablas en una sola?.</p>
<p>Si vemos la tabla de datos unificada, nos daremos cuenta que hay valores faltantes en el ingreso per cápita por país.</p>
<p>Podemos nuevamente usar filter para tirar tales registros.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># tirar datos faltantes</span>
esperanza_ingreso =<span class="st"> </span>esperanza_ingreso <span class="op">%&gt;%</span>
<span class="st">                    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(GNI_capita_<span class="dv">2010</span>))</code></pre></div>
<p>Ahora estamos listos para ajustar un model lineal entre estas dos variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># visualizar datos</span>
<span class="kw">ggplot</span>(esperanza_ingreso, <span class="kw">aes</span>(GNI_capita_<span class="dv">2010</span>, le)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>country_name),<span class="dt">position=</span><span class="kw">position_jitter</span>(<span class="dt">width=</span><span class="dv">2</span>,<span class="dt">height=</span><span class="dv">2</span>),<span class="dt">size=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-133-1.png" width="288" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># ajustar modelo</span>
modelo &lt;-<span class="st"> </span><span class="kw">lm</span>(le <span class="op">~</span><span class="st"> </span>GNI_capita_<span class="dv">2010</span>, <span class="dt">data =</span> esperanza_ingreso)

<span class="co"># sumario del modelo</span>
<span class="kw">summary</span>(modelo)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = le ~ GNI_capita_2010, data = esperanza_ingreso)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;    Min     1Q Median     3Q    Max </span>
<span class="co">#&gt; -22.89  -2.20   1.01   3.44   8.22 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)     5.02e+01   5.32e-01   94.37   &lt;2e-16 ***</span>
<span class="co">#&gt; GNI_capita_2010 2.62e-04   2.62e-05    9.99   &lt;2e-16 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 4.94 on 158 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.387,  Adjusted R-squared:  0.383 </span>
<span class="co">#&gt; F-statistic: 99.8 on 1 and 158 DF,  p-value: &lt;2e-16</span></code></pre></div>
</div>
<div id="visualizacion-de-predicciones" class="section level3">
<h3><span class="header-section-number">7.2.5</span> visualización de predicciones</h3>
<p>Para visualizar las predicciones de nuestro modelo se puede usar abline como se hizo anteirormente. Una manera más general de hacerlo es primero generar una gradilla regular sobre la región donde se encuentran nuestros datos. La manera más fácil de hacer esto es usando la función data_grid() del paquete modelr. Su primer argumento es un data frame y para cada argumento subsecuente encuentra valores únicos y genera todas las combinaciones:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
gradilla &lt;-<span class="st"> </span>esperanza_ingreso <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">            </span><span class="kw">data_grid</span>(GNI_capita_<span class="dv">2010</span>) 

gradilla
<span class="co">#&gt; # A tibble: 155 x 1</span>
<span class="co">#&gt;    GNI_capita_2010</span>
<span class="co">#&gt;              &lt;dbl&gt;</span>
<span class="co">#&gt;  1             440</span>
<span class="co">#&gt;  2             540</span>
<span class="co">#&gt;  3             580</span>
<span class="co">#&gt;  4             720</span>
<span class="co">#&gt;  5             780</span>
<span class="co">#&gt;  6             820</span>
<span class="co">#&gt;  7             860</span>
<span class="co">#&gt;  8             900</span>
<span class="co">#&gt;  9             950</span>
<span class="co">#&gt; 10             990</span>
<span class="co">#&gt; # ... with 145 more rows</span></code></pre></div>
<p>Luego se pueden agregar predicciones, esto se hace con la función add_predictions(). Las agrega a una nueva columna del data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
gradilla &lt;-<span class="st"> </span>gradilla <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">            </span><span class="kw">add_predictions</span>(modelo) 

gradilla
<span class="co">#&gt; # A tibble: 155 x 2</span>
<span class="co">#&gt;    GNI_capita_2010  pred</span>
<span class="co">#&gt;              &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1             440  50.3</span>
<span class="co">#&gt;  2             540  50.3</span>
<span class="co">#&gt;  3             580  50.3</span>
<span class="co">#&gt;  4             720  50.4</span>
<span class="co">#&gt;  5             780  50.4</span>
<span class="co">#&gt;  6             820  50.4</span>
<span class="co">#&gt;  7             860  50.4</span>
<span class="co">#&gt;  8             900  50.4</span>
<span class="co">#&gt;  9             950  50.4</span>
<span class="co">#&gt; 10             990  50.4</span>
<span class="co">#&gt; # ... with 145 more rows</span></code></pre></div>
<p>Ahora podemos visualizar las predicciones. Te podrás preguntar por qué hacer todo esto si lo resolvimos antes de manera sencilla utilizando geom_abline(). La ventaja de esta manera de hacerlo es que funciona para cualquier modelo, del más simple al más complejo.</p>
<p>Ver: <a href="http://vita.had.co.nz/papers/model-vis.html" class="uri">http://vita.had.co.nz/papers/model-vis.html</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(esperanza_ingreso, <span class="kw">aes</span>(GNI_capita_<span class="dv">2010</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> le)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> pred), <span class="dt">data =</span> gradilla, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-136-1.png" width="288" /></p>
<p>Se puede observar que el modelo no es particularmente bueno ¿Cómo se puede cuantificar lo bueno o malo que es? Una posibilidad es con la información arrojada por la función summary. Otra es checando los residuales y llevando a cabo un ejercicio de particionado de los datos entrenamiento/prueba como se mencionó al principio de la clase.</p>
</div>
<div id="visualizacion-de-residuales" class="section level3">
<h3><span class="header-section-number">7.2.6</span> visualización de residuales</h3>
<p>Los residuales son como el otro lado de la moneda de las predicciones. Las predicciones te indican qué patrón ha capturado el modelo, los residuales indican en cuánto ha fallado el modelo. Los residuales son simplemente las distancias entre los valores observados y predichos (por el modelo).</p>
<p>Agregamos los residuales a la tabla de datos con la función add_residuals(). Aunque aquí usaremos la tabla de datos original puesto que para computar los residuales se necesitan los valores observados.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
esperanza_ingreso &lt;-<span class="st"> </span>esperanza_ingreso <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                     </span><span class="kw">add_residuals</span>(modelo)</code></pre></div>
<p>Hay varias cosas que se pueden estudiar con los residuales. Por ejemplo, si se grafica un polígono de frecuencias podemos visualizar su dispersión.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(esperanza_ingreso, <span class="kw">aes</span>(resid)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_freqpoly</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-138-1.png" width="288" /></p>
<p>Esto puede ayudar a calibrar el modelo: ¿qué tan lejos están las predicciones de los valores originales observados? En los modelos lineales de este tipo, por construcción la media de los residuales es 0.</p>
<p>También es informativo hacer visualizaciones utilizando los residuales en vez de la variable dependiente original.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">ggplot</span>(esperanza_ingreso, <span class="kw">aes</span>(GNI_capita_<span class="dv">2010</span>, resid)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_ref_line</span>(<span class="dt">h =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() </code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-139-1.png" width="288" /></p>
<p>En un buen modelo el gráfico anterior debe verse como ruido aleatorio. Aquí este no es el caso, por lo que es claro que no se han capturado bien los patrones del conjunto de datos.</p>
<p>Aún así, el modelo sí ayuda a concluir que hay una relación positiva entre ingreso y esperanza de vida.</p>
<p><img src="imagenes/manicule2.jpg" /> ¿Por qué crees que el modelo no logró capturar bien el patrón del conjunto de datos?.</p>
<p><img src="imagenes/manicule.jpg" /> Entregar un script donde se lleve a cabo un ejercicio de particionado del conjunto de datos para encontrar el mejor modelo multivariado que explique el ingreso (al revés de como se ha venido trabajando):</p>
<p><span class="math display">\[ ingreso = \beta_{0} + \beta_{1}*esperanzaVidaGrupoEdad_1,...,\beta_{n}*esperanzaVidaGrupoEdad_n\]</span></p>
<p>Utilizar este modelo para estimar el ingreso de los datos faltantes 2010 ¿Se obtienen valores razonables?</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelado.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/Clase-8.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
